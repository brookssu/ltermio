# ltermio - A Lightweight POSIX terminal I/O library

The package contains 5 modules: **cursor**, **termkey**, **termouse**, **color256** and **unicon**. Tested only on **MacOS terminal** and **iTerm2**, so the platform compatibility has not been well verfied yet.  
All functions are based on **XTerm** specification, **CSI** sequences and **termios**, no additional requirements other than the standard library.

**Applicability**: They are only for **POSIX** terminal applications.

## Installation
Uses pip to install the package:

`pip3 install ltermio`

## History & Why
As we all know, character terminal are outdated facilities, why did I still write such a package?

When I was learning **Python** a few months ago, I decided to write a terminal **Tetris** game as a practice of the language learning. Due to the learning reason, I did not want to use any third-party packages. So when I finally finished the game, there naturally formed this by-product.

## color256 module
Sets 256-color display attributes of character terminal.

There are three pairs of functions to set or restore colors according to their literal name:

`
    set_fcolor(color)
    reset_fcolor()

    set_bcolor(color)
    reset_bcolor()

    set_color()
    reset_color()
`

Enum class **Color** defined constants of some common-used colors and grayscales, and more colors can be generated by function **make_color(r, g, b)**.

A simple sample as following:

`
    import ltermio
    from ltermio import Color

    ltermio.set_color(Color.GOLD, Color.BLUE)
    print('Hello, ltermio!')
    color = ltermio.make_color(4, 3, 1) # get a bronze color
    ltermio.set_fcolor(color)
    ...
    ltermio.reset_color()
`

Reference: <https://en.wikipedia.org/wiki/ANSI_escape_code>

## cursor module
Wrapper functions of the **CSI(Control Sequence Introducer)** sequences about cursor and screen.

The sequences of following functions based on are not part of the **ANSI** specification, but be supported by most of terminals.

`
    show_cursor()
    hide_cursor()
    switch_screen()
    restore_screen()
`

A several of additional functions are provided for text composing:

`
    v_composing()
    downward_seq()
    vert_seq()
    rect_border_seq()
`

References:  
<https://en.wikipedia.org/wiki/ANSI_escape_code>  
<https://www.xfree86.org/current/ctlseqs.html>

## termkey module
Functions to read input in non-canonical mode.

There are 5 **curses** like functions:

+ **getch()**: Gets a character from stdin.
+ **ungetch()**: Puts one or more characters into the key buffer.
+ **getkey()**: Calls getch() and transforms character to keycode.
+ **ungetkey()**: Puts a keycode into the key buffer.
+ **setparams()**: Sets frenquently-used attributes of the input.

And a function to support mouse tracking.

+ **mouse_handler()**: Sets a function to handle mouse report.

Function keycodes in common using are defined in enum class **Key**.

A typical usage example as following:

`
    import ltermio
    from ltermio import Key

    ltermio.setparams(echo=False)
    key = ltermio.getkey()
    while key != Key.ESC:
        ...
        key = ltermio.getkey()
    ltermio.setparams()
`

## termouse module
Detects and reports mouse events.

The implementation of the module follows the **XTerm** specification of the mouse tracking and uses normal tracking mode, see also:

<https://www.xfree86.org/current/ctlseqs.html#Mouse%20Tracking>
    
Calls **ltermio.mouse_tracking_on()** to turn on the mouse tracking, or sets the parameter `mouse=True` on the decorator **ltermio.appentry()**.

The mouse events are reported by **ltermio.getkey()**, with value encoded in a 32-bits integer and larger than **Key.MOUSE_EVENT**. It is simple to make difference from normal key codes by `code > Key.MOUSE_EVENT`.  
Decodes the event codes by calling **ltermio.decode_mouse_event()** which returns a tuple with explicit items.
        
An example to get key and mouse inputs as following:

`
    from ltermio import Key, MouseEvent

    ltermio.mouse_tracking_on()
    ltermio.setparams(echo=False)

    code = ltermio.getkey()
    while code != Key.CONTROL_X:
        if code > Key.MOUSE_EVENT:
            event, row, col, modifiers = ltermio.decode_mouse_event(code)
            if event == MouseEvent.B1_CLICKED:
                ... # do something with mouse event
        else:
            ... # do something with key input
        code = ltermio.getkey()

    ltermio.setparams(echo=True)
    ltermio.mouse_tracking_off()
`

## unicon module
Collection of some common icons in unicode character set.
